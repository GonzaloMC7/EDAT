LAS FOREIGN KEYS NO SIRVEN PARA NADA

1. Dado un título, ¿Cuántas ediciones tiene? ¿En cuántos idiomas?

	a)
		SELECT	COUNT("ISBN")
		FROM	"Edicion"
		WHERE	"Titulo_vo"='Game of thrones'


	b)
	SELECT COUNT(P.idiom)
	FROM (SELECT DISTINCT "Idioma" as idiom
      	      FROM	"Edicion"
              WHERE     "Titulo_vo"='Tokio blues') as P



2. ¿Cuántos libros se han vendido de un autor dado?

	SELECT	COUNT(V."Id_Venta")
	FROM	"Escrito_Por" as S, "Vendido" as V
	WHERE   S."Autor_id"='1' AND V."ISBN"=S."ISBN" 

3. ¿Cuántos libros de un autor dado se han vendido en oferta?


	SELECT COUNT(P."idv")
	FROM	(SELECT	VD."Id_Venta" as idv, V."Fecha" as date
		FROM	"Escrito_Por" as EP ,"Vendido" as VD, "Ventas" as V
		WHERE	EP."Autor_id"='1' AND  EP."ISBN"=VD."ISBN" AND VD."Id_Venta"=V."Identificador Venta") as P,
		"Vendido" as V, "Ofertas" as O
	WHERE 	P."idv"=V."Id_Venta" AND V."ISBN"=O."ISBN" AND 	P."date"<=O."Fin" AND O."Inicio"<=P."date"







4. ¿Cuánto dinero se ha ganado vendiendo libros de un editor dado?



	SELECT 	SUM(P."pp")-SUM(E."Costos")
	FROM	(SELECT	VD."Id_Venta" as idv, V."Precio Pagado" as pp
		 FROM	"Escrito_Por" as EP, "Vendido" as VD, "Ventas" as V
		 WHERE	EP."Autor_id"='1' AND EP."ISBN"=VD."ISBN" AND VD."Id_Venta"=V."Identificador Venta" ) as P,
 		 "Vendido" as VD, "Edicion" as E
	WHERE	P."idv"=VD."Id_Venta" and VD."ISBN"=E."ISBN"
	GROUP BY E."ISBN"
	


5. ¿Cuántos libros han comprado los usuarios fidelizados?

	SELECT COUNT("Identificador Venta")
	FROM "Ventas"
	WHERE "DNI" IS NOT NULL




6. ¿Cuántos usuarios fidelizados han comprado libros en inglés?

	SELECT COUNT(P."d") 
	FROM	(SELECT DISTINCT "DNI" as d
			FROM "Ventas" as V, "Vendido" as N, "Edicion" as E
			WHERE V."DNI" IS NOT NULL AND  E."Idioma"='Ingles'
			AND V."Identificador Venta"=N."Id_Venta" 
			AND N."ISBN"=E."ISBN") as P



7. ¿Cuánto dinero se ha ganado vendiendo libros en Francés?

/*Probamos con ingles porque no tenemos libros en Frances*/
/*En realidad tampoco tenemos en ingles vendidos pero agregue un par para probar*/
/*Un par de ventas*/

SELECT	SUM(V."Precio Pagado")-SUM(E."Costos")
FROM "Ventas" as V, "Vendido" as VD, "Edicion" as E
WHERE E."ISBN"=VD."ISBN" AND VD."Id_Venta"=V."Identificador Venta"
      AND E."Idioma"='Espanol'
GROUP BY E."Idioma"



8. ¿En que días hubo ofertas de libros de la editorial Adelpi?
 
/*PROBAMOS CON EDITORIALES PLANETA SM ANAYA EDEBE, no tenemos adelpi*/

	SELECT O."Inicio", O."Fin"
	FROM "Edicion" as E, "Ofertas" as O
	WHERE	E."Editor"='Adelpi' AND O."ISBN"=E."ISBN"

SOLO FALTA PROBAR EL EJERCICIO 9

9. ¿Qué usuarios fidelizados no han comprado nunca libros de bolsillo?

	(SELECT V.DNI
	FROM VENTAS)
	
	EXCEPT

	(SELECT V.DNI
	FROM VENTAS as V, Vendido as N, EDICION as E
	WHERE V.DNI=N.DNI and E.tapa="Bolsillo")











